name: CI/CD Base Setup
description: Perform basic cache restoration and node+yarn install steps
inputs:
  node-version:
    description: Node.js version to run with
    required: true
    default: 14.x
runs:
  - name: Use Node.js ${{ inputs.node-version }}
    uses: actions/setup-node@v1
    with:
      node-version: ${{ inputs.node-version }}
  - name: Configure yarn cache path
    run: yarn config set cache-folder ~/.yarn-cache
  - name: Restore yarn cache
    uses: actions/cache@v2
    with:
      path: ~/.yarn-cache
      key: yarn-cache-${{ inputs.node-version }}
      restore-keys: |
        yarn-cache-
  - name: Restore node_modules
    uses: actions/cache@v2
    with:
      path: node_modules
      key: node-modules-${{ inputs.node-version }}-${{ hashFiles('yarn.lock') }}
      restore-keys: |
        node-modules-${{ inputs.node-version }}-
        node-modules-
  - name: Install dependencies
    run: yarn
